extends layout

block content

    div.area
        h1 Team | #{team.name}
        input(type='hidden' name='userEmails' value='#{userEmails}')
        div
            .row
                .col-md-3
                    img(src='#{team.image}' alt='image' style='width:300px;height:200px;' class="rounded")
                    form(name='update' method='post' action='/teams/edit/#{team.id}' encType = 'multipart/form-data')
                        .form-group
                            label Name
                            input.form-control(type='text' value='#{team.name}' name='name')
                        .form-group
                            label Description
                            textarea.form-control(maxlength='125' name='description') #{team.description}
                        .form-group
                            label Team Leader
                            input.form-control(type='text' readonly='' value='#{team.leader.username}')
                        .form-group
                            label Created By
                            input.form-control(type='text' readonly='' value='#{team.createdBy.username}')
                        .form-group
                            label Created Date
                            input.form-control(type='text' readonly='' value='#{team.createdDate}')
                        .form-group
                            label Updated By
                            input.form-control(type='text' readonly='' value='#{team.updatedBy.username}')
                        .form-group
                            label Updated Date
                            input.form-control(type='text' readonly='' value='#{team.updatedDate.toLocaleTimeString()}')
                        .form-group 
                            input(type='file' class='form-control-file' name='image')
                        .form-group 
                            input(type='hidden' name='currentImage' value='#{team.image}')
                        input(class='btn btn-success' type='submit' value='Save')

                .col-md-6
                    if(errors)
                            ul.list-group
                                each err in errors
                                    li.list-group-item.text-danger= err
                    div.area
                        h1 Action Items
                        lable 
                        .row
                            .col
                                input#searchAction.form-control(type='text' placeholder='Search Action Item...')
                            .col
                                input#searchActionOwner.form-control(type='text' placeholder='Search Owner...')
                        lable Status Filter
                        .row
                            .col
                                
                                select.form-control#StatusOptions(name='selectedStatus')
                                    option(value='ALL') All
                                    option(value='NEW') Open
                                    option(value='COMPLETED') Done
                                    option(value='CANCELLED') Cancelled
                            .col
                                a.btn.btn-success#filterStatus(href='#') Filter
                        </br>
                        table.table#actionItems
                            thead
                                tr
                                    th(scope='col') Action Item
                                    th(scope='col') Owner
                                    th(scole='col') Retro
                                    th(scole='col') Status
                                    th(scope='col') 
                            tbody#myTable
                                each i in team.actionitems
                                    tr
                                        th #{i.text}
                                        th #{i.owner.username}
                                        th #{i.retrospective.name}
                                        th
                                            input(type='hidden' name='actionStatus' value='#{i.status}') 
                                            if i.status == 'NEW'
                                                span.material-icons(style='color: orange' title="Open") 
                                                 | flag
                                            if i.status == 'COMPLETED'
                                                span.material-icons(style='color: green' title="Done") 
                                                 | done 
                                            if i.status == 'CANCELLED'
                                                span.material-icons(style='color: red' title="Cancelled") 
                                                 | close 
                                        th
                                            .btn-group(role='group')
                                                button.material-icons(type='button' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false')
                                                    | more_horiz
                                                .dropdown-menu(aria-labelledby='btnGroupDrop1')
                                                    if i.status == 'NEW'
                                                        a.dropdown-item(href='/action/complete/#{i._id}') Complete
                                                        a.dropdown-item(href='/action/cancel/#{i._id}') Cancel
                                                    else
                                                        a.dropdown-item(href='/action/open/#{i._id}') Open
                        h1 Retrospectives
                        form(name='newRetro' method='post' action='/retro/create')
                            .form-group
                                h3 Create New
                                .row
                                    .col.5
                                        select.form-control(name='selectedTemplate')
                                            option(value='0') Select a template
                                            each t in templates.templates
                                                option(value='#{t.number}')=t.name
                                    .col.5
                                        input(type='hidden' name='teamID' value='#{team.id}')
                                        input(type='hidden' name='user' value='#{user._id}')
                                        input.form-control(type='text' placeholder='Title' name='retrospective')
                                    .col.2
                                        input(class='btn btn-success' type='submit' value='Create')
                            </br>
                        table.table
                            thead
                                tr
                                    th(scope='col') Title
                                    th(scope='col') Date
                                    th(scope='col') Status
                                    th(scope='col') Join
                            tbody
                                each i in team.retrospectives
                                    tr
                                        th #{i.name}
                                        th.date-util() #{i.createdDate}
                                        th
                                            if i.status == 'NEW' || i.status == 'INPROGRESS' || i.status == 'REVIEW'
                                                span.material-icons(style='color: red' title="In Progress") 
                                                 | settings_input_antenna
                                            else
                                                span.material-icons(style='color: green' title="Completed") 
                                                 | done                                              
                                        th
                                            if i.status === 'COMPLETED'
                                                a(href='/retro/complete/#{i.id}')
                                                    span.material-icons
                                                        | play_circle_outline
                                            else
                                                a(id='join' href='/retro/live/#{i.id}')
                                                    span.material-icons
                                                        | play_circle_outline
                .col-md-3
                    div#participants
                        h2 Members
                        div
                            each m in team.members
                                .user(id="#{m._id}")
                                    a.avatar.teammember(style='background-image: url(#{m.image});' href='/user/details/#{m._id}')
                                    if team.leader._id.equals(m._id)
                                        .leader
                                            span.material-icons.leader-icon(style='align: center' title='Leader')
                                                | brightness_low
                                    .infosPlayer
                                        span.nick=m.username
                                        a.remove-member(href='#')
                                            span.material-icons(href='#' team-id = team._id member-id = m._id style="color:red")
                                                | delete
                        div
                            form(name='addmember' method='post' action='/teams/add/member/#{team.id}')
                                .form-group
                                    label Add Team Member
                                    input.form-control#addMemberInput(type='text' placeholder='member@email.com' name='memberEmail')
                                input(class='btn btn-success' type='submit' value='Add')


