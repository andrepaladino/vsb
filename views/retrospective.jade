extends layout

block content

    div.area
        h1 Retrospective | #{retro.name}
            input(type='hidden' name='user' value='#{user._id}')
            input(type='hidden' name='retroID' value='#{retro._id}')
            input(type='hidden' name='retroTemplateNumber' value='#{retro.retroTemplate.number}')
        .input-group.mb-3
        if(retro.status == 'INPROGRESS')
            .row.row-cols-3
                .col
                    select#inputCategory.form-control
                        each i in retro.retroTemplate.categories
                            option(value='#{i.id}')=i.name
                .col
                    form(id='chat')
                        input.form-control(type='text' name='message')
                        input(class='btn btn-success' type='submit' value='Add')
            </br>
        if team.leader == user._id
            if retro.status != 'NEW'
                a.btn.btn-success.previousstep(href='#' ) Previous
            if retro.status != 'REVIEW'
                a.btn.btn-success.nextstep(href='#' ) Next
            else
                a.btn.btn-success.completeRetro(href='#') Complete
        .row
            .col-md-10
                if(retro.status == 'NEW')
                    h1 Open Action Items
                    table.table
                        thead
                            tr
                                th(scope='col') Action Item
                                th(scope='col') Owner
                                th(scole='col') Retro
                                th(scole='col') Status
                                th(scope='col') Complete
                                th(scole='col') Cancel
                        tbody
                            each i in team.actionitems
                                if(i.status == "NEW")
                                    tr
                                        th #{i.text}
                                        th #{i.owner.username}
                                        th #{i.retrospective.name}
                                        th #{i.status}
                                        th    
                                            a.btn.btn-info.complete-action(href='#')
                                                span.material-icons(action-id = i._id)
                                                    |   done_outline
                                        th    
                                            a.btn.btn-danger.cancel-action(href='#')
                                                span.material-icons(action-id = i._id)
                                                    |   clear
                if(retro.status == 'INPROGRESS')
                    div#includedContent
                if(retro.status == 'REVIEW')
                    h3 Review
                        form(id='actionitem')
                            .row
                                .col-md-3
                                    label Action Item
                                    input.form-control(type='text' placeholder='Action Item' name='actionitem')
                                .col-md-3
                                    label Owner
                                    select.form-control(name='selectMember')
                                        each m in team.members
                                            option(value='#{m._id}')=m.username
                                .col-md-3
                                    </br>
                                    input(class='btn btn-success' type='submit' value='Add')
                        </br>
                    table.table
                        thead
                            tr
                                th(scope='col') Action Item
                                th(scope='col') Owner
                                th(scole='col') Retro
                                th(scole='col') Status
                                th(scope='col') Complete
                                th(scole='col') Cancel
                        tbody(id='actionitems')
                            each ai in team.actionitems
                                if(ai.status == "NEW")
                                    tr
                                        th #{ai.text}
                                        th #{ai.owner.username}
                                        th #{ai.retrospective.name}
                                        th #{ai.status}
                                        th    
                                            a.btn.btn-info(href='#')
                                                span.material-icons.complete-action(action-id = ai._id)
                                                    |   done_outline
                                        th    
                                            a.btn.btn-danger.cancel-action(href='#')
                                                span.material-icons(action-id = ai._id)
                                                    |   clear
            .col-md-2
                div#participants.participants
                    h2 Participants
                    div
                        each m in team.members
                            .user(id="#{m._id}")
                                a.avatar(style='background-image: url(#{m.image});' href='/user/details/#{m._id}')
                                .infosPlayer
                                    span.nick=m.username
                                    span.inputQnt 0
                                    i  inputs                                


    script(src='https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.js')
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    script(type='text/javascript' src='/javascripts/retro.js')